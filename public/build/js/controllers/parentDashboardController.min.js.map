{"version":3,"sources":["parentDashboardController.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"parentDashboardController.min.js","sourcesContent":["angular.module('myapp')\n.controller('ParentDashboardController', ['Restangular', '$modal',\nfunction (Restangular, $modal) {\n    var vm = this;\n\n    vm.stuList = [];\n    vm.scores = [];\n    vm.msg = '載入中....';\n    //vm.stuList = Restangular.allUrl('manage-link').getList().$object;\n\n    var loadList = function(){\n        Restangular.allUrl('manage-link').getList().then(\n            function(response){\n                vm.stuList = response;\n                if(!vm.stuList.length){\n                    vm.msg = '請先新增學生';\n                }\n            }\n        );\n    };\n\n    vm.del = function(item){\n        console.log(item.id);\n        Restangular.one('manage-link', item.id).remove().then(\n            function(response){\n                vm.stuList.splice(vm.stuList.indexOf(item), 1);\n            }\n        );\n    };\n\n    vm.showModal = function(){\n        var modalInstance = $modal.open({\n            templateUrl: 'partials/modals/findStu.html',\n            controller: 'FindStuModalInstanceCtrl',\n            controllerAs: 'ModalCtrl',\n            size: 'sm'\n        });\n\n        modalInstance.result\n            .then(function (stu) {\n                var postData = {\n                    class_id: stu.class_id,\n                    stu_id: stu.id\n                };\n                Restangular.allUrl('manage-link').post(postData).then(\n                  function(response){\n                      vm.stuList.push(stu);\n                  }\n                );\n            }, function () {\n                console.info('Find Stu Modal dismissed at: ' + new Date());\n            });\n    };\n\n    vm.showScore = function (stu) {\n        vm.currStu = stu;\n        vm.scores = [];\n        vm.msgScore = '資料載入中....';\n        Restangular.one('query-scores', stu.id).get().then(\n            function(response){\n                vm.scores = response.scores;\n                if(!vm.scores.length){\n                    vm.msgScore = '沒有資料';\n                }\n            }\n        );\n    };\n\n    loadList();\n\n}])\n\n.controller('FindStuModalInstanceCtrl', ['$modalInstance', 'Restangular', function ($modalInstance, Restangular) {\n    var vm = this;\n    var step = 'step1';\n\n    vm.ok = function () {\n        $modalInstance.close(vm.foundStu);\n    };\n\n    vm.search = function(){\n        Restangular.oneUrl('findClassByCode', 'find-by-code/' + vm.stu.classCode + '/' + vm.stu.stuCode).get()//.customGET('findClassByCode', {code: vm.stu.classCode})\n            .then(\n                function(response){\n                    if(response.stu){\n                        vm.foundClass = response.class;\n                        vm.foundStu = response.stu;\n                    }else{\n                        vm.hasError = true;\n                    }\n                    step = 'step2';\n                }\n        );\n    };\n\n    // 依據步驟決定哪些 ui element 要顯示\n    vm.show = function(check){\n        return step == check;\n    };\n\n    vm.cancel = function () {\n        $modalInstance.dismiss('cancel');\n    };\n\n    vm.prevStep = function(){\n        vm.hasError = false;\n        step = 'step1';\n    };\n}]);"],"sourceRoot":"/source/"}